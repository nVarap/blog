<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">JS Api - Weather in a Place</h1><p class="page-description">Read the title please</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-23T00:00:00-05:00" itemprop="datePublished">
        Oct 23, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#Hacks">Hacks</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#enter-city-and-mmddyyyy">Enter city and MM/DD/YYYY</a></li>
</ul><!-- HTML table fragment for page -->
<!-- Script is layed out in a sequence (no function) and will execute when page is loaded -->

<h1 id="enter-city-and-mmddyyyy">
<a class="anchor" href="#enter-city-and-mmddyyyy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enter city and MM/DD/YYYY</h1>
<p><input type="text" id="city" name="city" value="London">
<input type="text" id="dty" name="dty" value="12/25/2022"></p>

<script>
    // prepare HTML result container for new output
    const body = document.getElementById("body");
    const resultContainer = document.getElementById("result");

    // prepare fetch options
    var info = {city :document.getElementById('city').value}
    const url = 'https://weatherapi-com.p.rapidapi.com/future.json?q=${info[]}&dt=2022-12-25';

    const options = {
        method: 'GET',
        headers: {
            'X-RapidAPI-Key': '721c8e8789msh4f6199095fcff35p13f037jsnc1e7998c8457',
            'X-RapidAPI-Host': 'weatherapi-com.p.rapidapi.com'
        }
    };;

    // fetch the API
    fetch(url, options)
        // response is a RESTful "promise" on any successful fetch
        .then(response => {
        // check for response errors
        if (response.status !== 200) {
            var text = document.createElement('div');
            text.innerHTML = errorMsg;
            document.appendChild(text);
            return;
        }
        // valid response will have json data
        response.json().then(data => {
            console.log(data);
            console.log(data.world_total)

            // World Data
            document.getElementById("time").innerHTML = data.world_total.statistic_taken_at;
            document.getElementById("total_cases").innerHTML = data.world_total.total_cases;
            document.getElementById("total_deaths").innerHTML = data.world_total.total_deaths;
            document.getElementById("active_cases").innerHTML = data.world_total.active_cases;

            // Country data
            for (const row of data.countries_stat) {
                console.log(row);

                // tr for each row
                const tr = document.createElement("tr");
                // td for each column
                const name = document.createElement("td");
                const cases = document.createElement("td");
                const deaths = document.createElement("td");
                const active = document.createElement("td");

                // data is specific to the API
                name.innerHTML = row.country_name;
                cases.innerHTML = row.cases; 
                deaths.innerHTML = row.deaths; 
                active.innerHTML = row.active_cases; 

                // this build td's into tr
                tr.appendChild(name);
                tr.appendChild(cases);
                tr.appendChild(deaths);
                tr.appendChild(active);

                // add HTML to container
                resultContainer.appendChild(tr);
            }
        })
    })
    // catch fetch errors (ie ACCESS to server blocked)
    .catch(err => {
        console.error(err);
        const tr = document.createElement("tr");
        const td = document.createElement("td");
        td.innerHTML = err;
        tr.appendChild(td);
        resultContainer.appendChild(tr);
    });
</script>


  </div><a class="u-url" href="/blog/hacks/2022/10/23/APIinJS.html" hidden></a>
</article>
